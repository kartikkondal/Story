this is chapter 5 in the newExp branch
